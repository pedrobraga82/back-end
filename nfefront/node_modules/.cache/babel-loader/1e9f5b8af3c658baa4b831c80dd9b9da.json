{"ast":null,"code":"import _slicedToArray from\"/home/pedrobraga/Projetos/nfefront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,Fragment}from'react';import{makeStyles}from'@material-ui/core/styles';import TextField from'@material-ui/core/TextField';import Header from'../Header';import NFETable from'./NFETable';import Select from'@material-ui/core/Select';import MenuItem from'@material-ui/core/MenuItem';import axios from'axios';import{useParams}from'react-router-dom';import Button from'@material-ui/core/Button';import DownloadLink from\"react-download-link\";import{ExportCSV}from'./ExportCSV';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{container:{display:'flex',flexWrap:'wrap',selectEmpty:{marginTop:theme.spacing(2)}},textField:{marginLeft:theme.spacing(1),marginRight:theme.spacing(1),width:200}};});export default function NFEListAdmin(){var classes=useStyles();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),dataini=_useState2[0],SetDataIni=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),datafim=_useState4[0],SetDataFim=_useState4[1];var _useState5=useState([{}]),_useState6=_slicedToArray(_useState5,2),data=_useState6[0],SetData=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),cnpj=_useState8[0],SetCnpj=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),username=_useState10[0],SetUsername=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),users=_useState12[0],SetUsers=_useState12[1];var _ref=[{}],nfe=_ref[0],SetNfe=_ref[1];var params=useParams();var _useState13=useState(new Date()),_useState14=_slicedToArray(_useState13,2),selectedDate=_useState14[0],handleDateChange=_useState14[1];useEffect(function(){if(users===\"\"){var url='/api/userslist';axios.get(url).then(function(response){var data=response.data;var dados=[{}];data.forEach(function(obj){dados.push(obj);});SetUsers(dados);}).catch(function(err){alert(\"Erro ao listar usuários \"+err);});}return function(){//cleanup\n};},[dataini,datafim,cnpj]);var GetNfes=function GetNfes(e){e.preventDefault();var url=\"/nfelist/\".concat(cnpj,\"/\").concat(dataini,\"/\").concat(datafim);axios.get(url,{params:{cnpj:cnpj,dataini:dataini,datafim:datafim}}).then(function(response){SetData(response.data);}).catch(function(err){alert(\"Erro ao trazer dados das nfes \"+err);});};var ExportExcel=function ExportExcel(){var url=\"/nfe/exportexcel/\".concat(cnpj,\"/\").concat(dataini,\"/\").concat(datafim);axios.get(url,{params:{cnpj:cnpj,dataini:dataini,datafim:datafim}}).then(function(response){/*#__PURE__*/_jsx(DownloadLink,{label:\"Save\",filename:response.data,exportFile:function exportFile(){return\"My cached data\";}});//SetData(response.data);\n}).catch(function(err){alert(\"Erro ao trazer dados das nfes \"+err);});};var handleChange=function handleChange(e){// setAge(event.target.value);\ne.preventDefault();switch(e.target.name){case\"dataini\":SetDataIni(e.target.value);break;case\"datafim\":SetDataFim(e.target.value);break;case\"cnpj\":var _username=e.target.value;var user=users.filter(function(e){return e.username===_username;});SetUsername(_username);//SetCnpj(JSON.stringify(user[0].cnpj).substring(1,cnpj.length-1))\nSetCnpj(user[0].cnpj);break;default:break;}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Header,{})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"form\",{className:classes.container,noValidate:true,children:[/*#__PURE__*/_jsx(TextField,{name:\"dataini\",id:dataini,value:dataini,label:\"Data Inicial\",type:\"date\",format:\"dd/MM/yyyy\",defaultValue:\"24-05-2018\",onChange:handleChange,className:classes.textField,InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsx(TextField,{name:\"datafim\",id:datafim,value:datafim,label:\"Data Final\",type:\"date\",defaultValue:\"24-05-2018\",onChange:handleChange,className:classes.textField,InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsxs(Select,{name:\"cnpj\",value:username,onChange:handleChange,displayEmpty:true,className:classes.selectEmpty,inputProps:{'aria-label':'Without label'},children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:/*#__PURE__*/_jsx(\"em\",{children:\"Selecionar CNPJ\"})}),users&&users.map(function(user){return/*#__PURE__*/_jsx(MenuItem,{value:user.username,children:user.username});})]})]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"default\",size:\"small\",onClick:GetNfes,children:\"Listar Nfe\"})})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(NFETable,{dados:data&&data})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"default\",size:\"small\",onClick:ExportExcel,children:\"Exportar Nfes\"})}),/*#__PURE__*/_jsx(ExportCSV,{csvData:data&&data,fileName:cnpj})]});}","map":{"version":3,"sources":["/home/pedrobraga/Projetos/nfefront/src/Components/NFE/NFEListAdmin.js"],"names":["React","useEffect","useState","Fragment","makeStyles","TextField","Header","NFETable","Select","MenuItem","axios","useParams","Button","DownloadLink","ExportCSV","useStyles","theme","container","display","flexWrap","selectEmpty","marginTop","spacing","textField","marginLeft","marginRight","width","NFEListAdmin","classes","dataini","SetDataIni","datafim","SetDataFim","data","SetData","cnpj","SetCnpj","username","SetUsername","users","SetUsers","nfe","SetNfe","params","Date","selectedDate","handleDateChange","url","get","then","response","dados","forEach","obj","push","catch","err","alert","GetNfes","e","preventDefault","ExportExcel","handleChange","target","name","value","user","filter","shrink","map"],"mappings":"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","sourcesContent":["import React,{useEffect,useState, Fragment} from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport Header from '../Header';\nimport NFETable from './NFETable';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport DownloadLink from \"react-download-link\";\nimport {ExportCSV} from './ExportCSV';\n\n\n\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    selectEmpty: {\n        marginTop: theme.spacing(2),\n      },\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: 200,\n  },\n}));\n\nexport default function NFEListAdmin() {\n\n    const classes = useStyles();\n    const [dataini,SetDataIni] = useState(null)\n    const [datafim,SetDataFim] = useState(null)\n    const [data,SetData] = useState([{}])\n    const [cnpj,SetCnpj] = useState(\"\")\n    const [username,SetUsername] = useState(\"\")\n    const [users,SetUsers] = useState(\"\")\n    const [nfe,SetNfe] = [{}]\n    const params = useParams();\n\n    const [selectedDate, handleDateChange] = useState(new Date());\n\n\n\n    useEffect(() => {\n\n        if (users === \"\") {\n            let url =  '/api/userslist' \n\n            axios.get(url)\n\n                .then((response) => {    \n\n                let data = response.data;\n                let dados = [{}]\n        \n                 data.forEach(obj => {\n                dados.push(obj)\n                })\n\n                SetUsers(dados);\n            \n            })\n            .catch((err) => {\n                alert(\"Erro ao listar usuários \" + err)\n            })  \n        }    \n    \n        \n\n        return () => {\n            //cleanup\n        }\n    }, [dataini,datafim,cnpj])\n\n\n   const GetNfes = (e) => {\n\n    e.preventDefault()\n\n    \n     let url = `/nfelist/${cnpj}/${dataini}/${datafim}`;\n\n\n     axios.get(url, {\n        params: {\n          cnpj,\n          dataini,\n          datafim\n        }\n      })\n    .then((response) => {\n\n        SetData(response.data);\n\n    })\n    .catch((err) => {\n\n        alert(\"Erro ao trazer dados das nfes \" + err);\n    })  \n \n   }\n    \n\n   const ExportExcel = () => {\n\n\n    let url = `/nfe/exportexcel/${cnpj}/${dataini}/${datafim}`;\n        \n      axios.get(url, {\n        params: {\n          cnpj,\n          dataini,\n          datafim\n        }\n      })\n    .then((response) => {\n\n\n        <DownloadLink\n            label=\"Save\"\n            filename={response.data}\n            exportFile={() => \"My cached data\"}\n        />\n        //SetData(response.data);\n\n    })\n    .catch((err) => {\n\n        alert(\"Erro ao trazer dados das nfes \" + err);\n    })  \n \n      \n\n\n   }\n\n    const handleChange = (e) => {\n       // setAge(event.target.value);\n\n       e.preventDefault();\n\n       switch(e.target.name) {\n\n           case \"dataini\":\n                SetDataIni(e.target.value)\n                 break;\n           case \"datafim\":\n                SetDataFim(e.target.value)\n                 break;\n           case \"cnpj\":\n\n                let username = e.target.value;  \n                let user = users.filter((e) => {\n                  return e.username === username\n                });\n                SetUsername(username)\n                //SetCnpj(JSON.stringify(user[0].cnpj).substring(1,cnpj.length-1))\n                SetCnpj(user[0].cnpj)\n                break;\n           default:\n               break;\n       }\n\n\n\n    };\n\n    return (\n        <div>\n            <div>\n                <Header />\n            </div>\n            <br></br>\n            <br></br>\n            <div>\n                    \n                <form className={classes.container} noValidate>\n\n                     <TextField\n                    name=\"dataini\"\n                    id={dataini}\n                    value={dataini}\n                    label=\"Data Inicial\"\n                    type=\"date\"\n                    format=\"dd/MM/yyyy\"\n                    defaultValue=\"24-05-2018\"\n                    onChange={handleChange}\n                    className={classes.textField}\n                    InputLabelProps={{\n                        shrink: true,\n                    }}\n                    /> \n                    <TextField\n                    name=\"datafim\"\n                    id={datafim}\n                    value={datafim}\n                    label=\"Data Final\"\n                    type=\"date\"\n                    defaultValue=\"24-05-2018\"\n                    onChange={handleChange}\n                    className={classes.textField}\n                    InputLabelProps={{\n                        shrink: true,\n                    }}\n                    />\n\n                    <Select\n                        name=\"cnpj\"\n                        value={username}\n                        onChange={handleChange}\n                        displayEmpty\n                        className={classes.selectEmpty}\n                        inputProps={{ 'aria-label': 'Without label' }}\n                    >\n                         <MenuItem value=\"\">\n                            <em>Selecionar CNPJ</em>\n                        </MenuItem>\n                        {users && users.map((user) => {\n                            return(\n                                 <MenuItem  value={user.username}>{user.username}</MenuItem>\n\n                            );   \n                        })}\n\n                        {/* <MenuItem value={20}>Twenty</MenuItem>\n                        <MenuItem value={30}>Thirty</MenuItem> */}\n                    </Select>\n\n                </form>\n                <br></br>\n                <br></br>\n                <div>\n                        <Button variant=\"contained\" color=\"default\" size='small'  onClick={GetNfes}>Listar Nfe</Button>\n                    </div>\n            </div>  \n            <div>\n                <NFETable dados={data && data} />\n            </div>\n            <div>\n            <Button variant=\"contained\" color=\"default\" size='small'  onClick={ExportExcel}>Exportar Nfes</Button>\n           </div>\n           <ExportCSV csvData={data && data} fileName={cnpj} />\n\n        </div>\n\n        )\n}\n"]},"metadata":{},"sourceType":"module"}