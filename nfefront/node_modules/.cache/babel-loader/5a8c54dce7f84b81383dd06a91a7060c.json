{"ast":null,"code":"var _jsxFileName = \"/home/pedrobraga/Projetos/nfefront/src/Components/NFE/FormNFE.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport 'materialize-css';\nimport TableNFE from './TableNFE';\nimport ExportExcel from '../ExportExcel';\nimport Header from '../Header';\nimport Table from 'react-bootstrap/Table';\nimport SaveIcon from '@material-ui/icons/Save';\nimport Button from '@material-ui/core/Button';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst username = localStorage.getItem(\"username\");\nconst cnpj = localStorage.getItem(\"cnpj\");\nexport default function FormNFE() {\n  _s();\n\n  //const  [cnpj,Setcnpj] =  useState(\"\");\n  const [texto, SetTexto] = useState(\"\");\n  const [dados, SetDados] = useState([{}]);\n  const [notas, SetNotas] = useState([]);\n  const token = 'jfhsdjklfhjsdl'; //localStorage.getItem('token');\n\n  const username = localStorage.getItem('usuario');\n  useEffect(() => {\n    let vetordados = {};\n    let arraydados = [{}];\n    let ns = [];\n    alert(cnpj);\n\n    if (texto != null && texto != \"\") {\n      for (let i = 0; i < texto.length; i++) {\n        let t = texto[i];\n        let cnpjremetente = t.substring(t.indexOf(\"<CNPJ>\"), t.lastIndexOf(\"</CNPJ>\")).split(\">\")[1];\n        let chnfe = t.substring(t.indexOf(\"<chNFe>\"), t.lastIndexOf(\"</chNFe>\")).split(\">\")[1];\n        let ie = t.substring(t.indexOf(\"<IE>\"), t.lastIndexOf(\"</IE>\")).split(\">\")[1];\n        let nome = t.substring(t.indexOf(\"<xNome>\"), t.lastIndexOf(\"</xNome>\")).split(\">\")[1]; //.replace(\"</xNome\",\"\");\n\n        let dataemissao = t.substring(t.indexOf(\"<dhEmi>\"), t.lastIndexOf(\"</dhEmi>\")).split(\">\")[1]; //.replace(\"</dhEmi\",\"\")\n        // .toLocaleDateString('pt-BR');\n\n        let valor = parseFloat(t.substring(t.indexOf(\"<vNF>\"), t.lastIndexOf(\"</vNF>\")).split(\">\")[1]);\n        let datarecebto = t.substring(t.indexOf(\"<dhRecbto>\"), t.lastIndexOf(\"</dhRecbto>\")).split(\">\")[1];\n        let tiponf = t.substring(t.indexOf(\"<tpNF>\"), t.lastIndexOf(\"</tpNF>\")).split(\">\")[1];\n        vetordados = {\n          \"cnpj\": cnpj,\n          \"chnfe\": chnfe,\n          \"ie\": ie,\n          \"tiponf\": tiponf,\n          \"nome\": nome,\n          \"valor\": valor,\n          \"dataemissao\": dataemissao,\n          \"cnpjremetente\": cnpjremetente\n        };\n        arraydados.push(vetordados);\n      }\n    }\n\n    SetNotas(ns);\n    SetDados(arraydados.filter(vetor => {\n      return vetor.valor != null;\n    }));\n    return () => {//\n    };\n  }, [texto]);\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    axios.get(`/nfe/${cnpj}`).then(function (response) {\n      SetTexto(response.data);\n    }).catch(function (error) {\n      console.log(error);\n      alert(error);\n    });\n  };\n  /*     const handleChange = (e) => {\n  \n          Setcnpj(e.target.value);\n      }\n   */\n\n\n  const SaveNfe = e => {\n    e.preventDefault();\n    let url = '/cadnfe';\n    let chave = e.target.id;\n    let nf = dados.filter(nfe => nfe.chnfe == chave); //\"41201211436073000147550010001425711047416300\" ) \n\n    axios.post(url, nf[0]).then(response => {//this.props.history.push(\"http://localhost:3000/listusers\");\n    }).catch(err => {\n      alert(\"Erro ao cadastrar Nfe \" + err);\n    });\n    e.target.disabled = true;\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"container my-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"Pesquisar NFE por CNPJ\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"input-field w-25\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            class: \"btn waves-effect waves-light\",\n            type: \"submit\",\n            children: [\"Pesquisar\", /*#__PURE__*/_jsxDEV(\"i\", {\n              class: \"material-icons right\",\n              children: \"send\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 17\n    }, this), \"                \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 21\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(Table, {\n        striped: true,\n        bordered: true,\n        hover: true,\n        variant: \"dark\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Chave\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Data Emiss\\xE3o\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Valor\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: \"Emitente\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 33\n            }, this), \"                          \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 27\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: dados && dados.map(result => {\n            const {\n              chnfe: chaveNfe,\n              dataemissao,\n              valor,\n              nome: emitente\n            } = result;\n            return dados && /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                children: chaveNfe ? chaveNfe.replace(\"</chNFe\", \"\") : \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 233,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: dataemissao ? new Date(dataemissao).getDay() + \"/\" + (new Date(dataemissao).getMonth() + 1) + \"/\" + new Date(dataemissao).getFullYear() : \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: valor ? parseFloat(valor) : 0\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: emitente ? emitente.replace(\"</xNome\", \"\") : \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 244,\n                columnNumber: 40\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"button\",\n                  class: \"btn btn-info\",\n                  id: chaveNfe,\n                  value: \"Salvar Nota\",\n                  onClick: SaveNfe\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 44\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 247,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 39\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: texto && texto\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 23\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 174,\n    columnNumber: 13\n  }, this);\n}\n\n_s(FormNFE, \"6606JDsd5pXu7ZCx9XDlr12ILio=\");\n\n_c = FormNFE;\n\nvar _c;\n\n$RefreshReg$(_c, \"FormNFE\");","map":{"version":3,"sources":["/home/pedrobraga/Projetos/nfefront/src/Components/NFE/FormNFE.js"],"names":["React","useState","useEffect","axios","TableNFE","ExportExcel","Header","Table","SaveIcon","Button","username","localStorage","getItem","cnpj","FormNFE","texto","SetTexto","dados","SetDados","notas","SetNotas","token","vetordados","arraydados","ns","alert","i","length","t","cnpjremetente","substring","indexOf","lastIndexOf","split","chnfe","ie","nome","dataemissao","valor","parseFloat","datarecebto","tiponf","push","filter","vetor","handleSubmit","event","preventDefault","get","then","response","data","catch","error","console","log","SaveNfe","e","url","chave","target","id","nf","nfe","post","err","disabled","map","result","chaveNfe","emitente","replace","Date","getDay","getMonth","getFullYear"],"mappings":"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","sourcesContent":["import React,{useState,useEffect} from 'react';\nimport axios from 'axios';\nimport 'materialize-css';\nimport TableNFE from './TableNFE';\nimport ExportExcel from '../ExportExcel';\nimport Header from '../Header';\nimport Table from 'react-bootstrap/Table'\nimport SaveIcon from '@material-ui/icons/Save';\nimport Button from '@material-ui/core/Button';\n\n\nconst username = localStorage.getItem( \"username\");\nconst cnpj = localStorage.getItem(\"cnpj\");\n\n\nexport default function FormNFE() {\n\n//const  [cnpj,Setcnpj] =  useState(\"\");\nconst  [texto,SetTexto] = useState(\"\");\nconst  [dados,SetDados] = useState([{}]);\nconst  [notas,SetNotas] = useState([]);\n\n\n\nconst token = 'jfhsdjklfhjsdl' //localStorage.getItem('token');\nconst username = localStorage.getItem('usuario');\n\n\nuseEffect(() => {\n  \n  let vetordados = {};\n  let arraydados = [{}];\n  let ns = [];\n\n  alert(cnpj)\n\n  if (texto != null && texto != \"\") {\n\n      for (let i=0; i < texto.length ; i++) {\n\n        let t = texto[i]\n        \n\n        let cnpjremetente = t.substring(\n            t.indexOf(\"<CNPJ>\") , \n            t.lastIndexOf(\"</CNPJ>\")\n          ).split(\">\")[1];\n\n          let chnfe = t.substring(\n            t.indexOf(\"<chNFe>\") , \n            t.lastIndexOf(\"</chNFe>\")\n          ).split(\">\")[1];\n\n          let ie = t.substring(\n              t.indexOf(\"<IE>\") , \n              t.lastIndexOf(\"</IE>\")\n            ).split(\">\")[1];\n\n\n            let nome = t.substring(\n              t.indexOf(\"<xNome>\") , \n              t.lastIndexOf(\"</xNome>\")\n              ).split(\">\")[1]//.replace(\"</xNome\",\"\");\n          \n            let dataemissao = t.substring(\n              t.indexOf(\"<dhEmi>\") , \n              t.lastIndexOf(\"</dhEmi>\")\n              ).split(\">\")[1]//.replace(\"</dhEmi\",\"\")\n             // .toLocaleDateString('pt-BR');\n          \n          \n            let valor = parseFloat(t.substring(\n                t.indexOf(\"<vNF>\") , \n                t.lastIndexOf(\"</vNF>\")\n              ).split(\">\")[1]);\n          \n              let datarecebto = t.substring(\n                t.indexOf(\"<dhRecbto>\") , \n                t.lastIndexOf(\"</dhRecbto>\")\n                ).split(\">\")[1];\n          \n              let tiponf = t.substring(\n                t.indexOf(\"<tpNF>\") , \n                t.lastIndexOf(\"</tpNF>\")\n              ).split(\">\")[1];\n\n         vetordados = {\n\n          \"cnpj\": cnpj,\n          \"chnfe\": chnfe,\n          \"ie\": ie,\n          \"tiponf\": tiponf,\n          \"nome\": nome,\n          \"valor\": valor,\n          \"dataemissao\": dataemissao,\n          \"cnpjremetente\": cnpjremetente\n        }      \n\n        arraydados.push(vetordados)\n\n\n      }\n\n    }         \n\n    SetNotas(ns);\n    SetDados(arraydados.filter((vetor) => {\n\n      return vetor.valor != null\n    }))\n  \n  return () => {\n    //\n  }\n}, [texto]) \n \nconst handleSubmit = (event) => {\n\n\n\n  event.preventDefault();\n\n  \n\n           axios.get(`/nfe/${cnpj}`)\n        .then(function (response) {\n            SetTexto(response.data);\n\n\n          })\n          .catch(function (error) {\n            console.log(error);\n            alert(error);\n          }); \n\n    }\n\n/*     const handleChange = (e) => {\n\n        Setcnpj(e.target.value);\n    }\n */\n    const SaveNfe = (e) => {\n\n        e.preventDefault()\n\n\n\n      let url =  '/cadnfe' \n      let chave = e.target.id;\n      let nf = dados.filter(nfe =>  nfe.chnfe == chave )\n        \n        //\"41201211436073000147550010001425711047416300\" ) \n\n\n        \n        axios.post(url, nf[0])\n          \n      .then((response) => {    \n              //this.props.history.push(\"http://localhost:3000/listusers\");\n      \n        })\n          .catch((err) => {\n              alert(\"Erro ao cadastrar Nfe \" + err)\n          }) \n  \n\n          e.target.disabled = true;\n\n    }\n\n\n        return (\n            <div>\n                <Header />\n\n\n               \n                <div class=\"container my-4\">\n                    <h4>Pesquisar NFE por CNPJ</h4>\n\n                    <div class=\"input-field w-25\">\n                        <form onSubmit={handleSubmit}>\n                            {/* <input type=\"text\" placeholder=\"Pesquisar por CNPJ\"  value={cnpj} onChange={handleChange} />         */}\n                            <button class=\"btn waves-effect waves-light\" type=\"submit\" >Pesquisar\n                                    <i class=\"material-icons right\">send</i>\n                            </button>\n                        </form>  \n                    </div>\n                </div>\n                <br></br>\n{/*                 <textarea value={JSON.stringify(dados)}>{dados && dados}</textarea>\n */}                <br></br>\n                <div>\n\n                <Table striped bordered hover variant=\"dark\">\n                        <thead>\n                          <tr>\n                                <th>Chave</th>\n                                <th>Data Emissão</th>\n                              {/*  <th>Número</th> */}\n                                <th>Valor</th>\n                       {/*          <th>Série</th>\n                                <th>Tipo</th> \n                                 <th>Valor</th>\n                                <th>Emitente CNPJ</th> */}\n                                <th>Emitente</th>\n                              {/*  <th>Emitente IE</th> \n                                <th>Emitente UF</th> \n                                 <th>Destinatário CNPJ</th> \n                                <th>Destinatário</th>\n                                <th>Destinarário IE</th>\n                                <th>Destinatário UF</th>\n */}                          </tr>\n                        </thead>\n                        <tbody>\n\n                            {dados &&  dados.map(\n                                  (result) => {\n                                                                  \n                                    const {\n                                      chnfe: chaveNfe,\n                                      dataemissao ,\n                                      valor,\n                                       nome: emitente\n                                                             \n                                  } = result;\n\n                                    return(\n\n                                      dados &&\n                                      <tr>\n                                        <td>{chaveNfe ? chaveNfe.replace(\"</chNFe\",\"\") : \"\"}</td>\n{/*                                         <td>{new Date(dataemissao).getDay() + \n                                          \"/\" + new Date(dataemissao).getMonth() +\n                                          \"/\" + new Date(dataemissao).getFullYear() }</td>\n */}\n                                        <td>{dataemissao ? \n                                            new Date(dataemissao).getDay() + \n                                              \"/\" + (new Date(dataemissao).getMonth()+1)  +\n                                              \"/\" + new Date(dataemissao).getFullYear() \n                                              : \"\"}</td>  \n                                        <td>{valor ? parseFloat(valor) : 0}</td> \n                                       <td>{emitente ? emitente.replace(\"</xNome\",\"\") : \"\"}</td> \n                                       {/* <td><SaveIcon id={chaveNfe} name={chaveNfe} onClick={SaveNfe}></SaveIcon></td>     \n                                    */}\n                                       <td><input type=\"button\" class=\"btn btn-info\" id={chaveNfe}  value=\"Salvar Nota\"  onClick={SaveNfe} /></td>     \n                                   \n                                      </tr>\n                                    )\n                                    \n                                  })       \n                            }\n      \n                  </tbody> \n                </Table>\n                    <div>\n                      <textarea value={texto && texto}></textarea>\n                    </div>\n                    {/* <ExportExcel dataSet={texto && texto}/>    */}\n                </div>\n            \n            </div>\n\n                          \n        )\n\n   \n        \n}    "]},"metadata":{},"sourceType":"module"}